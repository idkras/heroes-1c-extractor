#!/usr/bin/env python3
"""
Ilya Krasinsky Review Challenge - MCP Backend
Adds challenge comments from Ilya Krasinsky to documents based on standards compliance
"""

import re
import json
import sys
from typing import Dict, List, Any, Optional
from datetime import datetime

sys.path.append('/home/runner/workspace')

class IlyaReviewChallenger:
    def __init__(self):
        self.challenge_patterns = {
            "user_centric": {
                "pattern": r"(–Ω–∞—à[–∞-—è]*\s+–ø—Ä–æ–¥—É–∫—Ç|–º—ã\s+–ø—Ä–µ–¥–ª–∞–≥–∞–µ–º|–∫–æ–º–ø–∞–Ω–∏—è\s+—è–≤–ª—è–µ—Ç—Å—è|–Ω–∞—à–∏\s+—É—Å–ª—É–≥–∏)",
                "comment": "–ò–ª—å—è –ö.: –ó–¥–µ—Å—å —è –≤–∏–∂—É —Ñ–æ–∫—É—Å –Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–µ –≤–º–µ—Å—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ –Ω–∞—à–µ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É, –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å '–ß—Ç–æ —è –ø–æ–ª—É—á—É?' —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π —á–µ—Ä–µ–∑ –ø—Ä–∏–∑–º—É –≤—ã–≥–æ–¥."
            },
            "cognitive_load": {
                "pattern": r"(—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ\s+—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏|—Å–ª–æ–∂–Ω—ã–µ\s+—Ç–µ—Ä–º–∏–Ω—ã|–±–µ–∑\s+–æ–±—ä—è—Å–Ω–µ–Ω–∏—è\s+–≤—ã–≥–æ–¥)",
                "comment": "–ò–ª—å—è –ö.: –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω—ã–π –Ω–∞–ª–æ–≥! –≠—Ç–æ—Ç –±–ª–æ–∫ –∑–∞–±–∏—Ä–∞–µ—Ç –≤–Ω–∏–º–∞–Ω–∏–µ, –Ω–æ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–¥–æ—Å—Ç—å, —Å–º—ã—Å–ª –∏–ª–∏ –ø–æ–ª—å–∑—É. –ü–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –ò–ª—å—è—Ö–æ–≤–∞ '—è—Å–Ω–æ-–ø–æ–Ω—è—Ç–Ω–æ' - –ª–∏–±–æ —É–±–∏—Ä–∞–µ–º, –ª–∏–±–æ –ø—Ä–µ–≤—Ä–∞—â–∞–µ–º –≤ –æ—á–µ–≤–∏–¥–Ω—É—é –≤—ã–≥–æ–¥—É."
            },
            "segment_gaps": {
                "pattern": r"(–æ–¥–∏–Ω\s+—Ä–∞–∑–º–µ—Ä\s+–¥–ª—è\s+–≤—Å–µ—Ö|—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ\s+—Ä–µ—à–µ–Ω–∏–µ|–æ–±—â–∏–µ\s+—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)",
                "comment": "–ò–ª—å—è –ö.: –ù–µ –≤–∏–∂—É —É—á–µ—Ç–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Å–µ–≥–º–µ–Ω—Ç–æ–≤. –ì–¥–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∏—Ö —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞—Ö–∏? –î–µ—Ç–∞–ª–∏ —Å–æ–∑–¥–∞—é—Ç –¥–æ–≤–µ—Ä–∏–µ - –¥–æ–±–∞–≤—å –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∑–æ–Ω–∏—Ä—É–µ—Ç –∏–º–µ–Ω–Ω–æ —Å —ç—Ç–æ–π –∞—É–¥–∏—Ç–æ—Ä–∏–µ–π."
            },
            "missing_vision": {
                "pattern": r"(–±–µ–∑\s+—á–µ—Ç–∫–æ–≥–æ\s+–ø–ª–∞–Ω–∞|–Ω–µ—Ç\s+–ø–æ—à–∞–≥–æ–≤—ã—Ö\s+–¥–µ–π—Å—Ç–≤–∏–π|–Ω–µ—è—Å–µ–Ω\s+—Ä–µ–∑—É–ª—å—Ç–∞—Ç)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω –ø–æ–ª—É—á–µ–Ω–∏—è –≤—ã–≥–æ–¥—ã? –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—É—Ç—å: –¥–µ–ª–∞—é –ê ‚Üí –ø–æ–ª—É—á–∞—é –ë ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞—é –¥—Ä—É–≥–∏–º –í. –ê—Ä—Ç–µ—Ñ–∞–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é."
            },
            "no_tasks": {
                "pattern": r"(—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏\s+–±–µ–∑\s+–∑–∞–¥–∞—á|–æ–±—â–∏–µ\s+—Å–æ–≤–µ—Ç—ã|–Ω–µ—Ç\s+–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö\s+–¥–µ–π—Å—Ç–≤–∏–π)",
                "comment": "–ò–ª—å—è –ö.: –û—Ç–ª–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑, –Ω–æ –≥–¥–µ –∑–∞–¥–∞—á–∏? –ù—É–∂–µ–Ω —Å–ø–∏—Å–æ–∫ —Å —Ä–æ–ª—è–º–∏, –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º, —Å—Å—ã–ª–∫–∞–º–∏ –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ —É—Å–ø–µ—Ö–∞. –î–≤–æ–π–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω."
            },
            "missing_insights": {
                "pattern": r"(–æ—á–µ–≤–∏–¥–Ω–∞—è\s+–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è|–±–∞–Ω–∞–ª—å–Ω—ã–µ\s+–≤—ã–≤–æ–¥—ã|–±–µ–∑\s+—É–¥–∏–≤–ª–µ–Ω–∏—è)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ —É–¥–∏–≤–ª–µ–Ω–∏–µ –ø–æ –®–µ–Ω–Ω–æ–Ω—É? –õ–µ–Ω–¥–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –¥–∞–≤–∞—Ç—å –∞–∫—Ç–∏–≤–∏—Ä—É—é—â–µ–µ –∑–Ω–∞–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ JTBD-—Å—Ü–µ–Ω–∞—Ä–∏–π. –°–µ–π—á–∞—Å —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è."
            },
            "trust_issues": {
                "pattern": r"(–æ–±–µ—â–∞–Ω–∏—è\s+–±–µ–∑\s+–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π|–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤—ã–µ\s+–¥–∞–Ω–Ω—ã–µ|—Å–æ–º–Ω–∏—Ç–µ–ª—å–Ω—ã–µ\s+—É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)",
                "comment": "–ò–ª—å—è –ö.: –ó–¥–µ—Å—å —Å–Ω–∏–∂–∞–µ—Ç—Å—è –¥–æ–≤–µ—Ä–∏–µ. –û–±–µ—â–∞–ª–∏ –æ–¥–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç–µ –¥—Ä—É–≥–æ–µ. –ü–æ –Ω–∞—à–µ–º—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –¥–æ–≤–µ—Ä–∏—è - –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –æ–±–µ—â–∞–Ω–∏—è."
            },
            "scissors_effect": {
                "pattern": r"(–ø—Ä–æ–±–ª–µ–º[–∞-—è]*\s+–æ–Ω–±–æ—Ä–¥–∏–Ω–≥|—Å–ª–æ–∂–Ω[–∞-—è]*\s+—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü|–º–Ω–æ–≥–æ\s+–ø–æ–ª–µ–π|–¥–æ–ª–≥[–∞-—è]*\s+–∑–∞–≥—Ä—É–∑–∫)",
                "comment": "–ò–ª—å—è –ö.: –í–∏–¥–∏—à—å —ç—Ñ—Ñ–µ–∫—Ç –Ω–æ–∂–Ω–∏—Ü? –ü–ª–æ—Ö–æ–π –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ ‚Üí ‚Üì–∫–æ–Ω–≤–µ—Ä—Å–∏—è ‚Üí ‚ÜëCAC ‚Üí ‚ÜìROI ‚Üí –º–µ–Ω—å—à–µ —Ç—Ä–∞—Ñ–∏–∫–∞. –ì–¥–µ —Ç–≤–æ—è –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è —Å–ø–∏—Ä–∞–ª—å?"
            },
            "peak_end_missing": {
                "pattern": r"(—Å—Ä–µ–¥–Ω[–∞-—è]*\s+–æ–ø—ã—Ç|–æ–±—ã—á–Ω[–∞-—è]*\s+–ø—Ä–æ—Ü–µ—Å—Å|—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω[–∞-—è]*\s+–ø—É—Ç—å)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ –ø–∏–∫ —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏—è –∏ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –æ–ø—ã—Ç? Disney –¥–µ–ª–∞–µ—Ç –æ—á–µ—Ä–µ–¥–∏ –≤–µ—Å–µ–ª—ã–º–∏, –∞ –≤—ã—Ö–æ–¥ - —á–µ—Ä–µ–∑ –º–∞–≥–∞–∑–∏–Ω –ø–æ–¥–∞—Ä–∫–æ–≤."
            },
            "no_zeigarnik": {
                "pattern": r"(–∑–∞–≤–µ—Ä—à–µ–Ω–Ω[–∞-—è]*\s+–ø—Ä–æ—Ü–µ—Å—Å|–ø–æ–ª–Ω[–∞-—è]*\s+–∏–Ω—Ñ–æ—Ä–º–∞—Ü|–≤—Å–µ\s+—Å—Ä–∞–∑—É)",
                "comment": "–ò–ª—å—è –ö.: –ß—Ç–æ –æ—Å—Ç–∞–≤–ª—è–µ—à—å –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–º? LinkedIn –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç '87% –ø—Ä–æ—Ñ–∏–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–æ'. –°–æ–∑–¥–∞–≤–∞–π –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ—Å—Ç–∏."
            },
            "no_decoy": {
                "pattern": r"(–¥–≤–∞\s+—Ç–∞—Ä–∏—Ñ–∞|–ø—Ä–æ—Å—Ç–æ–π\s+–≤—ã–±–æ—Ä|—Ç–æ–ª—å–∫–æ\s+–æ–¥–∏–Ω\s+–≤–∞—Ä–∏–∞–Ω—Ç)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ —Ç–≤–æ–π '–ø—Ä–∏–º–∞–Ω–æ—á–Ω—ã–π' —Ç–∞—Ä–∏—Ñ? Economist –ø—Ä–æ–¥–∞–≤–∞–ª –ø–æ–¥–ø–∏—Å–∫—É: digital $59, print $125, digital+print $125. –ö—Ç–æ –≤—ã–±–µ—Ä–µ—Ç —Ç–æ–ª—å–∫–æ print?"
            },
            "no_isolation": {
                "pattern": r"(–≤—Å–µ\s+–æ–¥–∏–Ω–∞–∫–æ–≤|–ø–æ—Ö–æ–∂[–∞-—è]*\s+—ç–ª–µ–º–µ–Ω—Ç|–Ω–µ—Ç\s+–≤—ã–¥–µ–ª–µ–Ω–∏—è)",
                "comment": "–ò–ª—å—è –ö.: –ß—Ç–æ –≤—ã–¥–µ–ª—è–µ—Ç—Å—è –∏–∑–æ–ª—è—Ü–∏–µ–π? Apple –¥–µ–ª–∞–µ—Ç iPhone –¥—Ä—É–≥–æ–≥–æ —Ü–≤–µ—Ç–∞ –≤ —Ä–µ–∫–ª–∞–º–µ. –û–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∫—Ä–∏—á–∞—Ç—å."
            },
            "no_effort_investment": {
                "pattern": r"(–≥–æ—Ç–æ–≤[–∞-—è]*\s+—Ä–µ—à–µ–Ω–∏–µ|–±–µ–∑\s+—É—Å–∏–ª–∏–π|–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∫–ª–∞–¥—ã–≤–∞–µ—Ç —É—Å–∏–ª–∏—è? Nike By You –¥–∞–µ—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—é –∫—Ä–æ—Å—Å–æ–≤–æ–∫. –¢—Ä—É–¥ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å."
            },
            "info_overload": {
                "pattern": r"(–≤—Å—è\s+–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è|–ø–æ–ª–Ω[–∞-—è]*\s+–æ–ø–∏—Å–∞–Ω–∏–µ|–≤—Å–µ\s+–¥–µ—Ç–∞–ª–∏\s+—Å—Ä–∞–∑—É)",
                "comment": "–ò–ª—å—è –ö.: –ù–µ –≤—ã–≤–∞–ª–∏–≤–∞–µ—à—å –≤—Å–µ —Å—Ä–∞–∑—É? TurboTax –∑–∞–¥–∞–µ—Ç –ø–æ –æ–¥–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É. –°–ª–æ–∂–Ω–æ—Å—Ç—å —É–±–∏–≤–∞–µ—Ç, –ø—Ä–æ—Å—Ç–æ—Ç–∞ –ø—Ä–æ–¥–∞–µ—Ç."
            },
            "no_ownership": {
                "pattern": r"(–Ω–∞—à[–∞-—è]*\s+–ø—Ä–æ–¥—É–∫—Ç|–æ–±—â[–∞-—è]*\s+—Ä–µ—à–µ–Ω–∏–µ|—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω[–∞-—è]*\s+–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)",
                "comment": "–ò–ª—å—è –ö.: –ö–∞–∫ –¥–µ–ª–∞–µ—à—å –ø—Ä–æ–¥—É–∫—Ç '–º–æ–∏–º'? Amazon –ø–∏—à–µ—Ç '–í–∞—à–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏'. Spotify —Å–æ–∑–¥–∞–µ—Ç '–ú–æ–π –º–∏–∫—Å'. –û–±–ª–∞–¥–∞–Ω–∏–µ –¥–æ –ø–æ–∫—É–ø–∫–∏."
            },
            "no_loss_aversion": {
                "pattern": r"(–ø–æ–ª—É—á[–∞-—è]*\s+–≤—ã–≥–æ–¥|–ø—Ä–∏–æ–±—Ä–µ—Ç[–∞-—è]*\s+–±–æ–Ω—É—Å|–ø–ª—é—Å[–∞-—è]*\s+–ø—Ä–æ–¥—É–∫—Ç)",
                "comment": "–ò–ª—å—è –ö.: –ß—Ç–æ —Ç–µ—Ä—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –ù–ï –∫—É–ø–∏–≤? Booking.com: '–û—Å—Ç–∞–ª–æ—Å—å 2 –Ω–æ–º–µ—Ä–∞, 5 —á–µ–ª–æ–≤–µ–∫ —Å–º–æ—Ç—Ä—è—Ç'. –ü–æ—Ç–µ—Ä—è > –ø—Ä–∏–æ–±—Ä–µ—Ç–µ–Ω–∏–µ."
            },
            "no_temporal_anchor": {
                "pattern": r"(–≤\s+–ª—é–±–æ–µ\s+–≤—Ä–µ–º—è|–∫–æ–≥–¥–∞\s+—É–¥–æ–±–Ω–æ|–±–µ–∑\s+–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)",
                "comment": "–ò–ª—å—è –ö.: –ü–æ—á–µ–º—É –ø–æ–∫—É–ø–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Å–µ–≥–æ–¥–Ω—è? Duolingo –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –æ –¥–Ω–µ —Ä–æ–∂–¥–µ–Ω–∏—è —Å—Ç—Ä–∏–∫–∞. –°–æ–∑–¥–∞–≤–∞–π –∑–Ω–∞—á–∏–º—ã–µ –º–æ–º–µ–Ω—Ç—ã."
            },
            "missing_trust_stack": {
                "pattern": r"(–Ω–µ—Ç\s+–æ—Ç–∑—ã–≤–æ–≤|–±–µ–∑\s+–¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤|–ø—Ä–æ—Å—Ç–æ\s+–ø–æ–≤–µ—Ä—å—Ç–µ)",
                "comment": "–ò–ª—å—è –ö.: –ö–∞–∫–æ–π —Å–ª–æ–π –¥–æ–≤–µ—Ä–∏—è —Å–µ–π—á–∞—Å —Å—Ç—Ä–æ–∏—à—å? Amazon –Ω–∞—á–∏–Ω–∞–µ—Ç —Å –∫–æ–º–ø–µ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ (–æ—Ç–∑—ã–≤—ã), –ø–æ—Ç–æ–º –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å (–¥–æ—Å—Ç–∞–≤–∫–∞), —ç–º–ø–∞—Ç–∏—è (–≤–æ–∑–≤—Ä–∞—Ç—ã), –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å (Prime)."
            },
            "generic_personas": {
                "pattern": r"(–¥–ª—è\s+–≤—Å–µ—Ö|—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–µ|–æ–¥–∏–Ω–∞–∫–æ–≤[–∞-—è]*\s+–ø–æ–¥—Ö–æ–¥)",
                "comment": "–ò–ª—å—è –ö.: –î–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ, –¥–ª—è –≤–∏–∑—É–∞–ª–∞ - —Å—Ö–µ–º—ã, –¥–ª—è –∫–∏–Ω–µ—Å—Ç–µ—Ç–∏–∫–∞ - –ø—Ä–æ–±–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. –ì–¥–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ–≤–µ—Ä–∏—è –ø–æ–¥ –ø—Å–∏—Ö–æ—Ç–∏–ø?"
            },
            "no_temporal_trust": {
                "pattern": r"(–±—ã—Å—Ç—Ä–æ–µ\s+—Ä–µ—à–µ–Ω–∏–µ|—Å—Ä–∞–∑—É\s+–ø–æ–∫—É–ø–∞–π|–Ω–µ\s+–¥—É–º–∞–π)",
                "comment": "–ò–ª—å—è –ö.: –ò–º–ø—É–ª—å—Å–∏–≤–Ω—ã–π –ø–æ–∫—É–ø–∞–µ—Ç –∑–∞ 3 –º–∏–Ω—É—Ç—ã, –∞–Ω–∞–ª–∏—Ç–∏–∫ –∏–∑—É—á–∞–µ—Ç –Ω–µ–¥–µ–ª—é. Netflix –¥–∞–µ—Ç —Å—Ä–∞–∑—É —Å–º–æ—Ç—Ä–µ—Ç—å, Tesla - —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã–µ."
            },
            "weak_social_proof": {
                "pattern": r"(–º–Ω–æ–≥–æ\s+–∫–ª–∏–µ–Ω—Ç–æ–≤|—Ç—ã—Å—è—á–∏\s+–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π|–≤—Å–µ\s+–¥–æ–≤–æ–ª—å–Ω—ã)",
                "comment": "–ò–ª—å—è –ö.: '–ú–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤' –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. 'IT-–¥–∏—Ä–µ–∫—Ç–æ—Ä –∏–∑ –°–±–µ—Ä–∞ —Å—ç–∫–æ–Ω–æ–º–∏–ª 40% –Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ' - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è IT-–¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤."
            },
            "no_value_alignment": {
                "pattern": r"(–æ–¥–Ω–∞\s+—Ü–µ–Ω–Ω–æ—Å—Ç—å|—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω[–∞-—è]*\s+–≤—ã–≥–æ–¥|–¥–ª—è\s+–≤—Å–µ—Ö\s+–ø–æ–ª–µ–∑–Ω–æ)",
                "comment": "–ò–ª—å—è –ö.: –î–ª—è CFO –≥–æ–≤–æ—Ä–∏ –ø—Ä–æ ROI, –¥–ª—è CTO - –ø—Ä–æ —Ç–µ—Ö–Ω–∏—á–Ω–æ—Å—Ç—å, –¥–ª—è CEO - –ø—Ä–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞. –û–¥–Ω–æ —Ä–µ—à–µ–Ω–∏–µ, —Ä–∞–∑–Ω—ã–µ —É–≥–ª—ã —Ü–µ–Ω–Ω–æ—Å—Ç–∏."
            },
            "missing_bias_segmentation": {
                "pattern": r"(–æ–¥–∏–Ω\s+–ø–æ–¥—Ö–æ–¥|–≤—Å–µ\s+–æ–¥–∏–Ω–∞–∫–æ–≤–æ|—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω[–∞-—è]*\s+–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è)",
                "comment": "–ò–ª—å—è –ö.: –ù–æ–≤–∏—á–∫–∏ –ª—é–±—è—Ç Authority (—ç–∫—Å–ø–µ—Ä—Ç—ã —Å–æ–≤–µ—Ç—É—é—Ç), –ø—Ä–æ—Ñ–∏ - Evidence (–¥–∞–Ω–Ω—ã–µ –≥–æ–≤–æ—Ä—è—Ç). –ö–∞–∫–æ–µ –∏—Å–∫–∞–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞?"
            },
            "no_risk_adaptation": {
                "pattern": r"(–æ–¥–∏–Ω\s+—Ä–∏—Å–∫|—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω[–∞-—è]*\s+–≥–∞—Ä–∞–Ω—Ç–∏–∏|–≤—Å–µ\s+–∑–∞—â–∏—â–µ–Ω—ã)",
                "comment": "–ò–ª—å—è –ö.: –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–æ—Ä—É –ø–æ–∫–∞–∂–∏ '–∏—Å–ø–æ–ª—å–∑—É—é—Ç 500 –∫–æ–º–ø–∞–Ω–∏–π', –∏–Ω–Ω–æ–≤–∞—Ç–æ—Ä—É - '–ø–µ—Ä–≤—ã–º–∏ –ø–æ–ª—É—á–∞—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ'. –ì–¥–µ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å?"
            },
            "weak_future_vision": {
                "pattern": r"(—Å—Ç–∞–Ω–µ—Ç–µ\s+–ª—É—á—à–µ|–±—É–¥–µ—Ç\s+—Ö–æ—Ä–æ—à–æ|—É–ª—É—á—à–∏—Ç—Å—è\s+–≤—Å–µ)",
                "comment": "–ò–ª—å—è –ö.: Startup-founder –º–µ—á—Ç–∞–µ—Ç –æ –º–∞—Å—à—Ç–∞–±–µ, –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä - –æ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏. Salesforce –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ '—É—Å–ø–µ—à–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏' —Ä–∞–∑–Ω—ã–º —Å–µ–≥–º–µ–Ω—Ç–∞–º."
            },
            "demographic_targeting": {
                "pattern": r"(–º—É–∂—á–∏–Ω—ã\s+30-40|–∂–µ–Ω—â–∏–Ω—ã\s+25-35|–≤–æ–∑—Ä–∞—Å—Ç[–∞-—è]*\s+–≥—Ä—É–ø–ø–∞)",
                "comment": "–ò–ª—å—è –ö.: –ù–µ '–º—É–∂—á–∏–Ω—ã 30-40', –∞ '–∫—Ç–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –±—ã—Å—Ç—Ä–æ vs –∫—Ç–æ –∏–∑—É—á–∞–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ'. Spotify –∑–Ω–∞–µ—Ç –º—É–∑—ã–∫–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –Ω–µ –≤–æ–∑—Ä–∞—Å—Ç."
            },
            "flat_emotional_journey": {
                "pattern": r"(–ø—Ä–æ—Å—Ç–æ\s+–∫—É–ø–∏—Ç–µ|–æ–¥–Ω–æ\s+—Ä–µ—à–µ–Ω–∏–µ|–±–µ–∑\s+—ç–º–æ—Ü–∏–π)",
                "comment": "–ò–ª—å—è –ö.: –°–æ–º–Ω–µ–Ω–∏–µ ‚Üí –ª—é–±–æ–ø—ã—Ç—Å—Ç–≤–æ ‚Üí –∏–Ω—Ç–µ—Ä–µ—Å ‚Üí –∂–µ–ª–∞–Ω–∏–µ ‚Üí —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å ‚Üí –¥–µ–π—Å—Ç–≤–∏–µ. –ù–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ —Ç–≤–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å? Apple Store –≤–µ–¥–µ—Ç –æ—Ç touch –∫ wow –∫ want –∫ buy."
            },
            "no_identity_alignment": {
                "pattern": r"(–ª—é–±–æ–π\s+–º–æ–∂–µ—Ç|–¥–ª—è\s+–≤—Å–µ—Ö\s+—Ç–∏–ø–æ–≤|–±–µ–∑\s+—Ä–∞–∑–ª–∏—á–∏–π)",
                "comment": "–ò–ª—å—è –ö.: '–Ø —ç–∫–æ-–æ—Å–æ–∑–Ω–∞–Ω–Ω—ã–π' ‚Üí Tesla. '–Ø —Å—Ç–∞—Ç—É—Å–Ω—ã–π' ‚Üí BMW. '–Ø –ø—Ä–∞–∫—Ç–∏—á–Ω—ã–π' ‚Üí Toyota. –ö–∞–∫ —Ç–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ —É–∫—Ä–µ–ø–ª—è–µ—Ç –∏—Ö self-image?"
            },
            "value_dump": {
                "pattern": r"(–≤—Å–µ\s+–ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞|–ø–æ–ª–Ω—ã–π\s+—Å–ø–∏—Å–æ–∫|–≤—Å—ë\s+–≤–∫–ª—é—á–µ–Ω–æ)",
                "comment": "–ò–ª—å—è –ö.: –ù–µ –≤—ã–≤–∞–ª–∏–≤–∞–π –≤—Å—é —Ü–µ–Ω–Ω–æ—Å—Ç—å —Å—Ä–∞–∑—É. Netflix: —Å–Ω–∞—á–∞–ª–∞ '—Å–º–æ—Ç—Ä–∏ —Å–µ—Ä–∏–∞–ª—ã', –ø–æ—Ç–æ–º '–±–µ–∑ —Ä–µ–∫–ª–∞–º—ã', –ø–æ—Ç–æ–º '—ç–∫—Å–∫–ª—é–∑–∏–≤—ã', –ø–æ—Ç–æ–º '—Å–∫–∞—á–∞–π –æ—Ñ–ª–∞–π–Ω'."
            },
            "no_ttv": {
                "pattern": r"(—Å–ª–æ–∂–Ω–∞—è\s+–Ω–∞—Å—Ç—Ä–æ–π–∫–∞|–¥–æ–ª–≥–∞—è\s+—É—Å—Ç–∞–Ω–æ–≤–∫–∞|–∏–∑—É—á–µ–Ω–∏–µ\s+—Ç—Ä–µ–±—É–µ—Ç)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ –∞–≥–∞-–º–æ–º–µ–Ω—Ç –≤ –ø–µ—Ä–≤—ã–µ 30 —Å–µ–∫—É–Ω–¥? TikTok –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∏–¥–µ–æ —Å—Ä–∞–∑—É, Canva –¥–∞–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å template –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. 78% never return –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è >2 –º–∏–Ω—É—Ç."
            },
            "no_anticipation": {
                "pattern": r"(–ø–æ–ª—É—á–∏—à—å\s+—Ä–µ–∑—É–ª—å—Ç–∞—Ç|–±—É–¥–µ—Ç\s+–¥–æ—Å—Ç—É–ø–Ω–æ|–æ–∂–∏–¥–∞–π)",
                "comment": "–ò–ª—å—è –ö.: –ö–∞–∫ —Å–æ–∑–¥–∞–µ—à—å –ø—Ä–µ–¥–≤–∫—É—à–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞? Spotify –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 'Discover Weekly –≥–æ—Ç–æ–≤', GitHub - 'Your code is building'. Expectation > experience."
            },
            "generic_activation": {
                "pattern": r"(–¥–ª—è\s+–≤—Å–µ—Ö\s+–æ–¥–∏–Ω–∞–∫–æ–≤–æ|—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π\s+–æ–ø—ã—Ç|—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è\s+–∞–∫—Ç–∏–≤–∞—Ü–∏—è)",
                "comment": "–ò–ª—å—è –ö.: B2C –Ω—É–∂–Ω–æ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–∞ 10 —Å–µ–∫, B2B - —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∑–∞ 60 —Å–µ–∫, Social - —Å–≤—è–∑—å —Å –ª—é–¥—å–º–∏, Achievement - –ø—Ä–æ–≥—Ä–µ—Å—Å. –ö–∞–∫–æ–π —Ç–∏–ø —É —Ç–≤–æ–µ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞?"
            },
            "no_curiosity_gap": {
                "pattern": r"(–≤—Å—ë\s+–ø–æ–Ω—è—Ç–Ω–æ|–±–µ–∑\s+–∏–Ω—Ç—Ä–∏–≥–∏|–ø—Ä–æ—Å—Ç–∞—è\s+–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ curiosity gap? LinkedIn –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç '–ö—Ç–æ —Å–º–æ—Ç—Ä–µ–ª –ø—Ä–æ—Ñ–∏–ª—å', Duolingo - 'Streak: 45 –¥–Ω–µ–π'. –°–æ–∑–¥–∞–≤–∞–π –∏–Ω—Ç—Ä–∏–≥—É –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è."
            },
            "no_investment": {
                "pattern": r"(–±–µ–∑\s+—É—Å–∏–ª–∏–π|–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏|–≥–æ—Ç–æ–≤–æ–µ\s+—Ä–µ—à–µ–Ω–∏–µ)",
                "comment": "–ò–ª—å—è –ö.: –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–Ω–≤–µ—Å—Ç–∏—Ä—É–µ—Ç –≤ –ø—Ä–æ–¥—É–∫—Ç? IKEA –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å, Instagram - –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å. –í–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å = –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å."
            },
            "flat_activation": {
                "pattern": r"(—Ä–æ–≤–Ω—ã–π\s+–æ–ø—ã—Ç|–±–µ–∑\s+–ø–∏–∫–æ–≤|—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ\s+–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–∏–∫ –∏ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –ø–µ—Ä–≤–∞—è —Å–µ—Å—Å–∏—è? Apple Store: touch iPhone ‚Üí wow ‚Üí –∫—É–ø–∏—Ç—å. Disney: –æ—á–µ—Ä–µ–¥—å ‚Üí excitement ‚Üí magical experience."
            },
            "no_scaffolding": {
                "pattern": r"(—Å—Ä–∞–∑—É\s+–≤—Å—ë|–±–µ–∑\s+–æ–±—É—á–µ–Ω–∏—è|–ø–æ–ª–Ω–∞—è\s+—Å–ª–æ–∂–Ω–æ—Å—Ç—å)",
                "comment": "–ò–ª—å—è –ö.: –ö–∞–∫ —É–±–∏—Ä–∞–µ—à—å training wheels? Duolingo: –ø–æ–¥—Å–∫–∞–∑–∫–∏ ‚Üí —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å, Photoshop: guided ‚Üí expert mode. Scaffolding –∏—Å—á–µ–∑–∞–µ—Ç —Å —Ä–æ—Å—Ç–æ–º skill."
            },
            "static_social_proof": {
                "pattern": r"(–ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ\s+–æ—Ç–∑—ã–≤—ã|—Å—Ç–∞—Ç–∏—á–Ω—ã–µ\s+—Ü–∏—Ñ—Ä—ã|—Å—Ç–∞—Ä—ã–µ\s+–∫–µ–π—Å—ã)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ live social proof? 'Sarah from London just created project', '5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–µ–π—á–∞—Å –æ–Ω–ª–∞–π–Ω'. Booking.com: 'In high demand!' –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å."
            },
            "choice_overload": {
                "pattern": r"(–º–Ω–æ–≥–æ\s+–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤|–≤—ã–±–µ—Ä–∏\s+—Å–∞–º|—Ä–∞–∑–ª–∏—á–Ω—ã–µ\s+–ø—É—Ç–∏)",
                "comment": "–ò–ª—å—è –ö.: –°–∫–æ–ª—å–∫–æ —Ä–µ—à–µ–Ω–∏–π —Ç—Ä–µ–±—É–µ—à—å —Å—Ä–∞–∑—É? Netflix –∞–≤—Ç–æ–≤—ã–±–∏—Ä–∞–µ—Ç —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å, Amazon - one-click –∫—É–ø–∏—Ç—å. –í—ã–±–æ—Ä = paralysis, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ = action."
            },
            "predictable_experience": {
                "pattern": r"(–æ–∂–∏–¥–∞–µ–º—ã–π\s+—Ä–µ–∑—É–ª—å—Ç–∞—Ç|—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π\s+–ø—Ä–æ—Ü–µ—Å—Å|–æ–±—ã—á–Ω—ã–π\s+–æ–ø—ã—Ç)",
                "comment": "–ò–ª—å—è –ö.: –ì–¥–µ overdelivery vs expectations? Zappos –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞ –Ω–æ—á—å –≤–º–µ—Å—Ç–æ –Ω–µ–¥–µ–ª–∏, Mailchimp –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç monkey animations. Surprised = remembered."
            },
            "cognitive_complexity": {
                "pattern": r"(—Å–ª–æ–∂–Ω—ã–µ\s+—à—Ä–∏—Ñ—Ç—ã|–Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–µ\s+—Ç–µ—Ä–º–∏–Ω—ã|–º–Ω–æ–≥–æ\s+–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏)",
                "comment": "–ò–ª—å—è –ö.: –ù–∞—Å–∫–æ–ª—å–∫–æ –ª–µ–≥–∫–æ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–µ—Ä–≤–æ–µ –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ? –ü—Ä–æ—Å—Ç—ã–µ —à—Ä–∏—Ñ—Ç—ã, –∑–Ω–∞–∫–æ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –æ—á–µ–≤–∏–¥–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è. Easy = valuable, hard = skip."
            },
            "no_activation_metrics": {
                "pattern": r"(–Ω–µ\s+–∏–∑–º–µ—Ä—è–µ–º|–±–µ–∑\s+–º–µ—Ç—Ä–∏–∫|–Ω–µ—Ç\s+–æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è)",
                "comment": "–ò–ª—å—è –ö.: –ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—à—å? Time to First Value <2 min, Session Depth >5 actions, Day 1 Retention >30%. Measure what matters for activation."
            }
        }
        
        self.document_type_specific = {
            "landing_review": {
                "required_sections": ["JTBD", "Value Proposition", "Social Proof", "Actionable Tasks"],
                "challenge_focus": ["user_centric", "segment_gaps", "missing_vision", "no_tasks"]
            },
            "analysis": {
                "required_sections": ["Data Analysis", "Insights", "Recommendations"],
                "challenge_focus": ["missing_insights", "no_tasks", "trust_issues"]
            },
            "recommendation": {
                "required_sections": ["Problem Statement", "Solution", "Implementation Plan"],
                "challenge_focus": ["no_tasks", "missing_vision", "trust_issues"]
            }
        }

    def analyze_document(self, content: str, doc_type: str = "landing_review") -> Dict[str, Any]:
        """
        –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–±–ª–∞—Å—Ç–∏ –¥–ª—è —á–µ–ª–ª–µ–Ω–¥–∂–∞
        """
        result = {
            "document_type": doc_type,
            "total_words": len(content.split()),
            "challenge_areas": [],
            "quality_score": 10.0,
            "missing_elements": [],
            "suggestions": []
        }
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è —á–µ–ª–ª–µ–Ω–¥–∂–∞
        for challenge_type, config in self.challenge_patterns.items():
            if doc_type in self.document_type_specific:
                if challenge_type in self.document_type_specific[doc_type]["challenge_focus"]:
                    if re.search(config["pattern"], content, re.IGNORECASE):
                        result["challenge_areas"].append({
                            "type": challenge_type,
                            "severity": "high",
                            "comment": config["comment"]
                        })
                        result["quality_score"] -= 1.5
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Å–µ–∫—Ü–∏–∏
        if doc_type in self.document_type_specific:
            required = self.document_type_specific[doc_type]["required_sections"]
            for section in required:
                if section.lower() not in content.lower():
                    result["missing_elements"].append(section)
                    result["quality_score"] -= 1.0
        
        return result

    def inject_challenges(self, content: str, analysis: Dict[str, Any]) -> str:
        """
        –í—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏-—á–µ–ª–ª–µ–Ω–¥–∂–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç
        """
        enhanced_content = content
        challenge_count = 0
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–±–ª–∞—Å—Ç–∏ —á–µ–ª–ª–µ–Ω–¥–∂–∞
        for challenge in analysis["challenge_areas"]:
            challenge_count += 1
            challenge_marker = f"\n\n> **üí≠ {challenge['comment']}**\n"
            
            # –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
            sections = enhanced_content.split('\n## ')
            if len(sections) > challenge_count:
                sections[challenge_count] += challenge_marker
                enhanced_content = '\n## '.join(sections)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –æ–±—â–∏–π –±–ª–æ–∫ —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
        if analysis["missing_elements"]:
            improvement_section = self._generate_improvement_section(analysis)
            enhanced_content += f"\n\n{improvement_section}"
        
        return enhanced_content

    def _generate_improvement_section(self, analysis: Dict[str, Any]) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–µ–∫—Ü–∏—é —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
        """
        section = "---\n\n## üéØ –ò–ª—å—è –ö.: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é\n\n"
        
        if analysis["missing_elements"]:
            section += "### –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã:\n"
            for element in analysis["missing_elements"]:
                section += f"- **{element}**: –î–æ–±–∞–≤–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Å–µ–∫—Ü–∏—é\n"
        
        section += f"\n### –¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞: {analysis['quality_score']:.1f}/10\n"
        
        if analysis['quality_score'] < 8.0:
            section += "\n> **–ò–ª—å—è –ö.: –î–æ–∫—É–º–µ–Ω—Ç —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º. –£—á—Ç–∏ –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤—ã—à–µ.**\n"
        elif analysis['quality_score'] < 9.0:
            section += "\n> **–ò–ª—å—è –ö.: –•–æ—Ä–æ—à–∞—è —Ä–∞–±–æ—Ç–∞, –Ω–æ –µ—Å—Ç—å —Ç–æ—á–∫–∏ —Ä–æ—Å—Ç–∞. –í–Ω–µ—Å–∏ –ø—Ä–∞–≤–∫–∏ –∏ –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–Ω–æ.**\n"
        else:
            section += "\n> **–ò–ª—å—è –ö.: –û—Ç–ª–∏—á–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª! –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞—à–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∫–∞—á–µ—Å—Ç–≤–∞.**\n"
        
        return section

    def challenge_specific_content(self, content: str, focus_areas: List[str]) -> Dict[str, Any]:
        """
        –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏ –∫ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –æ–±–ª–∞—Å—Ç—è–º
        """
        challenges = []
        
        for area in focus_areas:
            if area in self.challenge_patterns:
                pattern_config = self.challenge_patterns[area]
                if re.search(pattern_config["pattern"], content, re.IGNORECASE):
                    challenges.append({
                        "area": area,
                        "comment": pattern_config["comment"],
                        "priority": "high"
                    })
        
        return {
            "focused_challenges": challenges,
            "recommendation": "–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –∏ –≤–Ω–µ—Å–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∫–∏."
        }

async def handle_ilya_review_challenge(args: Dict[str, Any]) -> Dict[str, Any]:
    """
    MCP handler –¥–ª—è –∫–æ–º–∞–Ω–¥—ã ilya-review-challenge
    """
    try:
        challenger = IlyaReviewChallenger()
        
        content = args.get("document_content", "")
        doc_type = args.get("document_type", "landing_review")
        focus_areas = args.get("focus_areas", [])
        
        if not content:
            return {
                "success": False,
                "error": "–¢—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞"
            }
        
        # –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–æ–∫—É–º–µ–Ω—Ç
        analysis = challenger.analyze_document(content, doc_type)
        
        # –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã
        if focus_areas:
            focused_result = challenger.challenge_specific_content(content, focus_areas)
            analysis["focused_challenges"] = focused_result["focused_challenges"]
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç
        enhanced_content = challenger.inject_challenges(content, analysis)
        
        return {
            "success": True,
            "original_content": content,
            "enhanced_content": enhanced_content,
            "analysis": analysis,
            "ilya_signature": f"Reviewed by Ilya Krasinsky on {datetime.now().strftime('%d %b %Y, %H:%M CET')}",
            "content": [{
                "type": "text",
                "text": f"# –î–æ–∫—É–º–µ–Ω—Ç —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –ò–ª—å–∏ –ö—Ä–∞—Å–∏–Ω—Å–∫–æ–≥–æ\n\n{enhanced_content}\n\n---\n*–ö–∞—á–µ—Å—Ç–≤–æ: {analysis['quality_score']:.1f}/10*"
            }]
        }
        
    except Exception as e:
        return {
            "success": False,
            "error": f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —á–µ–ª–ª–µ–Ω–¥–∂–∞: {str(e)}",
            "content": [{
                "type": "text", 
                "text": f"–û—à–∏–±–∫–∞: {str(e)}"
            }]
        }

if __name__ == "__main__":
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    test_content = """
    # –ê–Ω–∞–ª–∏–∑ –ª–µ–Ω–¥–∏–Ω–≥–∞
    
    –ù–∞—à–∞ –∫–æ–º–ø–∞–Ω–∏—è –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞.
    –ú—ã —è–≤–ª—è–µ–º—Å—è –ª–∏–¥–µ—Ä–∞–º–∏ —Ä—ã–Ω–∫–∞ —Å 10-–ª–µ—Ç–Ω–∏–º –æ–ø—ã—Ç–æ–º.
    
    ## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
    –£–ª—É—á—à–∏—Ç—å –¥–∏–∑–∞–π–Ω –∏ –¥–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.
    """
    
    challenger = IlyaReviewChallenger()
    analysis = challenger.analyze_document(test_content, "landing_review")
    enhanced = challenger.inject_challenges(test_content, analysis)
    
    print("=== ORIGINAL ===")
    print(test_content)
    print("\n=== ENHANCED ===")
    print(enhanced)
    print(f"\nQuality Score: {analysis['quality_score']:.1f}/10")