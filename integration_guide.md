# Руководство по интеграции с файлами 1CD проекта prosto-svet

## Обзор

Проект tools_ui_1c содержит готовую инфраструктуру для работы с файлами 1CD через утилиту ctool1cd. 
Это позволяет извлекать метаданные и структуру данных из файлов проекта prosto-svet.

## Компоненты

### 1. Утилита ctool1cd
- **Расположение**: `tools_ui_1c/src/Инструменты/src/CommonTemplates/УИ_ctool1cd/Template.bin`
- **Функции**: Анализ структуры файловых баз 1С, экспорт метаданных в CSV
- **Поддержка**: Windows (ctool1cd.exe) и Linux (ctool1cd)

### 2. Обработка "Структура хранения базы данных"
- **Расположение**: `tools_ui_1c/src/Инструменты/src/DataProcessors/УИ_СтруктураХраненияБазыДанных`
- **Функции**: Визуализация размеров таблиц, интеграция с ctool1cd

### 3. Общие модули
- **Расположение**: `tools_ui_1c/src/Инструменты/src/CommonModules`
- **Функции**: Работа с файлами, запуск процессов, обработка результатов

## План интеграции

### Этап 1: Подготовка
1. Изучить структуру файлов prosto-svet
2. Определить необходимые данные для извлечения
3. Подготовить тестовые файлы 1CD

### Этап 2: Разработка обработки
1. Создать новую обработку в tools_ui_1c
2. Интегрировать ctool1cd
3. Реализовать парсинг CSV результатов

### Этап 3: Функционал
1. Добавить выбор файлов 1CD
2. Реализовать анализ структуры
3. Создать экспорт результатов

## Пример использования

```python
# Анализ файла 1CD
from pathlib import Path
import subprocess

def analyze_1cd_file(ctool1cd_path, file_1cd_path):
    cmd = [
        str(ctool1cd_path),
        "-ne", "-sts", "output.csv",
        "-q", str(file_1cd_path),
        "-l", "log.txt"
    ]
    
    result = subprocess.run(cmd, capture_output=True, text=True)
    return result.returncode == 0
```

## Возможности извлечения данных

### Метаданные таблиц
- Имена таблиц
- Количество записей
- Размеры данных и индексов
- Структура полей

### Структура базы
- Связи между таблицами
- Индексы
- Ограничения

### Статистика
- Размеры таблиц
- Пространство на диске
- Производительность

## Рекомендации

1. **Тестирование**: Начните с небольших файлов 1CD
2. **Обработка ошибок**: Добавьте проверки целостности файлов
3. **Производительность**: Используйте пакетную обработку для множества файлов
4. **Безопасность**: Проверяйте пути к файлам и права доступа

## Следующие шаги

1. Создать прототип обработки
2. Протестировать на реальных файлах prosto-svet
3. Добавить специфичную логику для проекта
4. Интегрировать в основную систему
