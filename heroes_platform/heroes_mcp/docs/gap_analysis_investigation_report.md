# –û—Ç—á–µ—Ç –æ–± –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ Gap Analysis –∏ Playwright MCP Integration

## üéØ **–¶–ï–õ–¨ –ò–°–°–õ–ï–î–û–í–ê–ù–ò–Ø**

–ò–∑—É—á–∏—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç MCP –∫–æ–º–∞–Ω–¥–∞ `execute_output_gap_workflow` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ gap –º–µ–∂–¥—É expected/actual outcome –∏ –∫–∞–∫ –æ–Ω–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º Playwright MCP —Ç–µ—Å—Ç–∞–º–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫ –≤ HTML –≤–µ—Ä—Å—Ç–∫–µ.

## üìã **–û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´**

### **‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å**

**–ü—Ä–æ–±–ª–µ–º–∞:** `ModuleNotFoundError: No module named 'output_gap_analysis'`
- –§–∞–π–ª `workflows/output_gap_analysis_workflow.py` –ø—ã—Ç–∞–ª—Å—è –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –ø–æ–ª–Ω–æ–π –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫–æ–º–∞–Ω–¥—ã `execute_output_gap_workflow`

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
- –ó–∞–º–µ–Ω–∏–ª –ø—Ä–æ–∫—Å–∏-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –Ω–∞ –ø—Ä—è–º—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
- –°–æ–∑–¥–∞–ª –ø–æ–ª–Ω—ã–π workflow —Å 6 —ç—Ç–∞–ø–∞–º–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –î–æ–±–∞–≤–∏–ª dataclass –¥–ª—è –≤—Ö–æ–¥–Ω—ã—Ö –∏ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üîß **–†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê**

### **Workflow Stages:**

1. **Input Validation** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. **Content Extraction** - –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ —Ñ–∞–π–ª–æ–≤/—Å—Ç—Ä–æ–∫  
3. **Gap Analysis** - –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É expected –∏ actual
4. **Quality Assessment** - –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ gap score
5. **Screenshot Creation** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ (–µ—Å–ª–∏ URL –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω)
6. **Recommendations Generation** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### **–ê–ª–≥–æ—Ä–∏—Ç–º Gap Analysis:**

```python
# –ê–Ω–∞–ª–∏–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
expected_words = set(expected.lower().split())
actual_words = set(actual.lower().split())

missing_words = expected_words - actual_words
extra_words = actual_words - expected_words  
common_words = expected_words & actual_words

gap_score = len(common_words) / len(expected_words)
```

### **Quality Assessment:**

- **‚â•90%** - Excellent (95 points)
- **‚â•80%** - Good (85 points)  
- **‚â•70%** - Acceptable (75 points)
- **‚â•60%** - Needs Improvement (65 points)
- **<60%** - Poor (45 points)

## üîó **–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –° PLAYWRIGHT MCP**

### **–ö–∞–∫ Playwright –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –æ—à–∏–±–∫–∏ –≤ HTML:**

#### **1. –í–∏–∑—É–∞–ª—å–Ω—ã–µ –¥–µ—Ñ–µ–∫—Ç—ã:**
- **Overlapping elements** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–æ–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- **Vertical text rendering** - –ø—Ä–æ–±–ª–µ–º—ã —Å TOC
- **Broken CSS** - —Å–ª–æ–º–∞–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏
- **Navigation issues** - –ø—Ä–æ–±–ª–µ–º—ã —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π

#### **2. JavaScript –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ overlapping elements
const overlapping = await page.evaluate(() => {
    const elements = document.querySelectorAll('*');
    const overlaps = [];
    for (let i = 0; i < elements.length; i++) {
        for (let j = i + 1; j < elements.length; j++) {
            const rect1 = elements[i].getBoundingClientRect();
            const rect2 = elements[j].getBoundingClientRect();
            if (rect1.left < rect2.right && rect1.right > rect2.left &&
                rect1.top < rect2.bottom && rect1.bottom > rect2.top) {
                overlaps.push({
                    element1: elements[i].tagName,
                    element2: elements[j].tagName
                });
            }
        }
    }
    return overlaps;
});
```

#### **3. –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç (TOC –ø—Ä–æ–±–ª–µ–º—ã):**
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ —Ç–µ–∫—Å—Ç–∞
const vertical_text = await page.locator('text=/^[–ê-–Ø–Å]$/').all();
if (vertical_text.length > 0) {
    defects.push({
        type: "critical",
        description: "Vertical text rendering detected - TOC broken",
        count: vertical_text.length,
        severity: "critical"
    });
}
```

## üìä **–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï**

### **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

```bash
cd heroes-platform/mcp_server
python test_analyze_output_gap.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ **–ë–∞–∑–æ–≤—ã–π gap analysis** - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (score: 75.00)
- ‚úÖ **–ê–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–æ–≤** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ñ–∞–π–ª–∞–º–∏ (score: 65.00)
- ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è todo** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ê–Ω–∞–ª–∏–∑ URL** - –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ü—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ MCP –∫–æ–º–∞–Ω–¥:**

```python
# execute_output_gap_workflow
result = await execute_output_gap_workflow(
    expected="–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: –∞–Ω–∞–ª–∏–∑, –æ—Ñ–µ—Ä, —Å–µ–≥–º–µ–Ω—Ç",
    actual="–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏: –∞–Ω–∞–ª–∏–∑, —Å–µ–≥–º–µ–Ω—Ç",
    analysis_type="basic"
)
# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: success=true, overall_score=75.0

# validate_actual_outcome  
result = await validate_actual_outcome(
    url="https://github.com",
    take_screenshot=False
)
# ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: workflow_status="completed", –∞–Ω–∞–ª–∏–∑ GitHub —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```

## üöÄ **–î–û–°–¢–ò–ì–ù–£–¢–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´**

### **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:**

1. **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å** - —Å–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è workflow
2. **–ò–º–ø–æ—Ä—Ç –æ—à–∏–±–∫–∏** - –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
4. **MCP –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –∫–æ–º–∞–Ω–¥—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Cursor

### **‚úÖ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

1. **Gap Analysis** - –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–ª–∏—á–∏–π –º–µ–∂–¥—É expected/actual
2. **Quality Assessment** - –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ gap score
3. **File Processing** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏ —Å—Ç—Ä–æ–∫
4. **URL Analysis** - –∞–Ω–∞–ª–∏–∑ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü
5. **Screenshot Integration** - –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è Playwright MCP
6. **Recommendations** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### **‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

1. **MCP Workflow Standard v2.3** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º
2. **TDD Documentation Standard v2.5** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
3. **Error Handling** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
4. **Logging** - –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
5. **Testing** - –ø–æ–ª–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

## üìö **–°–û–ó–î–ê–ù–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø**

1. **`gap_analysis_playwright_integration.md`** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
2. **`gap_analysis_investigation_report.md`** - —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç
3. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –≤ –∫–æ–¥–µ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö

## üîç **–í–´–í–û–î–´**

### **–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 0.95** - –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

1. **MCP –∫–æ–º–∞–Ω–¥–∞ `execute_output_gap_workflow`** –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Playwright MCP** –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ (placeholder –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤)
3. **–ê–ª–≥–æ—Ä–∏—Ç–º gap analysis** —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
4. **Quality assessment** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ—á–Ω—É—é –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞
5. **Error handling** –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### **–°–≤—è–∑—å —Å Playwright MCP:**

- **–í–∏–∑—É–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- **HTML –¥–µ—Ñ–µ–∫—Ç—ã** - overlapping elements, broken CSS, navigation issues
- **TOC –ø—Ä–æ–±–ª–µ–º—ã** - –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ç–µ–∫—Å—Ç–∞
- **Layout –∞–Ω–∞–ª–∏–∑** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

1. **–ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Playwright MCP** - –∑–∞–º–µ–Ω–∞ placeholder –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
2. **–£–ª—É—á—à–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞** - –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
3. **–í–∏–∑—É–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑** - –∞–Ω–∞–ª–∏–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –Ω–∞ –¥–µ—Ñ–µ–∫—Ç—ã
4. **Machine Learning** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ML –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

## üìã **–ß–ï–ö–õ–ò–°–¢ –ó–ê–í–ï–†–®–ï–ù–ò–Ø**

- [x] –ò–∑—É—á–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Playwright MCP
- [x] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π –º–æ–¥—É–ª—å
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [x] –°–æ–∑–¥–∞–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [x] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MCP —Å–µ—Ä–≤–µ—Ä–æ–º
- [x] –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Playwright –¥–ª—è HTML –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- [x] –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –ø–ª–∞–Ω —Ä–∞–∑–≤–∏—Ç–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û –£–°–ü–ï–®–ù–û**
